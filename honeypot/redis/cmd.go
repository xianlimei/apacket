package redis

var allowCMDMap = map[string]bool{
	"DEL":               true,
	"DUMP":              true,
	"EXISTS":            true,
	"EXPIRE":            true,
	"EXPIREAT":          true,
	"KEYS":              true,
	"MIGRATE":           true,
	"MOVE":              true,
	"OBJECT":            true,
	"PERSIST":           true,
	"PEXPIRE":           true,
	"PEXPIREAT":         true,
	"PTTL":              true,
	"RANDOMKEY":         true,
	"RENAME":            true,
	"RENAMENX":          true,
	"RESTORE":           true,
	"SORT":              true,
	"TTL":               true,
	"TYPE":              true,
	"SCAN":              true,
	"APPEND":            true,
	"BITCOUNT":          true,
	"BITOP":             true,
	"BITFIELD":          true,
	"DECR":              true,
	"DECRBY":            true,
	"GET":               true,
	"GETBIT":            true,
	"GETRANGE":          true,
	"GETSET":            true,
	"INCR":              true,
	"INCRBY":            true,
	"INCRBYFLOAT":       true,
	"MGET":              true,
	"MSET":              true,
	"MSETNX":            true,
	"PSETEX":            true,
	"SET":               true,
	"SETBIT":            true,
	"SETEX":             true,
	"SETNX":             true,
	"SETRANGE":          true,
	"STRLEN":            true,
	"HDEL":              true,
	"HEXISTS":           true,
	"HGET":              true,
	"HGETALL":           true,
	"HINCRBY":           true,
	"HINCRBYFLOAT":      true,
	"HKEYS":             true,
	"HLEN":              true,
	"HMGET":             true,
	"HMSET":             true,
	"HSET":              true,
	"HSETNX":            true,
	"HVALS":             true,
	"HSCAN":             true,
	"HSTRLEN":           true,
	"BLPOP":             true,
	"BRPOP":             true,
	"BRPOPLPUSH":        true,
	"LINDEX":            true,
	"LINSERT":           true,
	"LLEN":              true,
	"LPOP":              true,
	"LPUSH":             true,
	"LPUSHX":            true,
	"LRANGE":            true,
	"LREM":              true,
	"LSET":              true,
	"LTRIM":             true,
	"RPOP":              true,
	"RPOPLPUSH":         true,
	"RPUSH":             true,
	"RPUSHX":            true,
	"SADD":              true,
	"SCARD":             true,
	"SDIFF":             true,
	"SDIFFSTORE":        true,
	"SINTER":            true,
	"SINTERSTORE":       true,
	"SISMEMBER":         true,
	"SMEMBERS":          true,
	"SMOVE":             true,
	"SPOP":              true,
	"SRANDMEMBER":       true,
	"SREM":              true,
	"SUNION":            true,
	"SUNIONSTORE":       true,
	"SSCAN":             true,
	"ZADD":              true,
	"ZCARD":             true,
	"ZCOUNT":            true,
	"ZINCRBY":           true,
	"ZRANGE":            true,
	"ZRANGEBYSCORE":     true,
	"ZRANK":             true,
	"ZREM":              true,
	"ZREMRANGEBYRANK":   true,
	"ZREMRANGEBYSCORE":  true,
	"ZREVRANGE":         true,
	"ZREVRANGEBYSCORE":  true,
	"ZREVRANK":          true,
	"ZSCORE":            true,
	"ZUNIONSTORE":       true,
	"ZINTERSTORE":       true,
	"ZSCAN":             true,
	"RANGEBYLEX":        true,
	"ZLEXCOUNT":         true,
	"ZREMRANGEBYLEX":    true,
	"PFADD":             true,
	"PFCOUNT":           true,
	"PFMERGE":           true,
	"GEOADD":            true,
	"GEOPOS":            true,
	"GEODIST":           true,
	"GEORADIUS":         true,
	"GEORADIUSBYMEMBER": true,
	"GEOHASH":           true,
	"PSUBSCRIBE":        true,
	"PUBLISH":           true,
	"PUBSUB":            true,
	"PUNSUBSCRIBE":      true,
	"SUBSCRIBE":         true,
	"UNSUBSCRIBE":       true,
	"DISCARD":           true,
	"EXEC":              true,
	"MULTI":             true,
	"UNWATCH":           true,
	"WATCH":             true,
	"EVAL":              true,
	"EVALSHA":           true,
	//"SCRIPT EXISTS":     true,
	//"SCRIPT FLUSH":      true,
	//"SCRIPT KILL":       true,
	//"SCRIPT LOAD":       true,
	"SCRIPT":       true,
	"AUTH":         true,
	"ECHO":         true,
	"PING":         true,
	"QUIT":         true,
	"SELECT":       true,
	"BGREWRITEAOF": true,
	"BGSAVE":       true,
	//"CLIENT GETNAME": true,
	//"CLIENT KILL":    true,
	//"CLIENT LIST":    true,
	//"CLIENT SETNAME": true,
	"CLIENT": true,
	"CONFIG": true,
	//"CONFIG GET":        true,
	//"CONFIG RESETSTAT":  true,
	//"CONFIG REWRITE":    true,
	//"CONFIG SET":        true,
	"DBSIZE": true,
	//"DEBUG OBJECT":   true,
	//"DEBUG SEGFAULT": true,
	"DEBUG":    true,
	"FLUSHALL": true,
	"FLUSHDB":  true,
	"INFO":     true,
	"LASTSAVE": true,
	"MONITOR":  true,
	"PSYNC":    true,
	"SAVE":     true,
	"SHUTDOWN": true,
	"SLAVEOF":  true,
	"SLOWLOG":  true,
	"SYNC":     true,
	"TIME":     true,
}

var cmdResponse = map[string]string{
	"AUTH": "+OK\r\n",
	"PING": "+PONG\r\n",
	//"info":binascii.unhexlify(INFO),
	"SETNX":     ":1\r\n",
	"DEL":       ":1\r\n",
	"EXISTS":    ":1\r\n",
	"INCR":      ":1\r\n",
	"INCRBY":    ":1\r\n",
	"DECR":      ":1\r\n",
	"DECRBY":    ":1\r\n",
	"DBSIZE":    ":1\r\n",
	"LASTSAVE":  ":1\r\n",
	"RENAMENX":  ":1\r\n",
	"MOVE":      ":1\r\n",
	"LLEN":      ":1\r\n",
	"SADD":      ":1\r\n",
	"SREM":      ":1\r\n",
	"SISMEMBER": ":1\r\n",
	"SCARD":     ":1\r\n",
	"TTL":       ":-1\r\n",
	"GET":       "$6\r\nnfoobar\r\n",
	"SCAN":      "*2\r\n$1\r\n0\r\n*1\r\n$21\r\n_kombu.binding.celery\r\n",
	"SSCAN":     "*2\r\n$1\r\n0\r\n*1\r\n$6\r\ncelery\r\n",
	"TYPE":      "+set\r\n",
}

const INFO = "24313832360d0a23205365727665720d0a72656469735f76657273696f6e3a322e382e31370d0a72656469735f6769745f736861313a30303030303030300d0a72656469735f6769745f64697274793a300d0a72656469735f6275696c645f69643a666163323238643139323865393265300d0a72656469735f6d6f64653a7374616e64616c6f6e650d0a6f733a4c696e757820322e362e33322d3232302e372e312e656c362e7838365f3634207838365f36340d0a617263685f626974733a36340d0a6d756c7469706c6578696e675f6170693a65706f6c6c0d0a6763635f76657273696f6e3a342e342e370d0a70726f636573735f69643a31313038310d0a72756e5f69643a643630333363656235623836333766333764663539616534646664363664373463653632343033640d0a7463705f706f72743a363337390d0a757074696d655f696e5f7365636f6e64733a31333231323937370d0a757074696d655f696e5f646179733a3135320d0a687a3a31300d0a6c72755f636c6f636b3a393932303131390d0a636f6e6669675f66696c653a2f6574632f72656469732f72656469732e636f6e660d0a0d0a2320436c69656e74730d0a636f6e6e65637465645f636c69656e74733a353935360d0a636c69656e745f6c6f6e676573745f6f75747075745f6c6973743a300d0a636c69656e745f626967676573745f696e7075745f6275663a300d0a626c6f636b65645f636c69656e74733a300d0a0d0a23204d656d6f72790d0a757365645f6d656d6f72793a3132353635373635360d0a757365645f6d656d6f72795f68756d616e3a3131392e38344d0d0a757365645f6d656d6f72795f7273733a36333937393532300d0a757365645f6d656d6f72795f7065616b3a3236383737333934340d0a757365645f6d656d6f72795f7065616b5f68756d616e3a3235362e33324d0d0a757365645f6d656d6f72795f6c75613a33333739320d0a6d656d5f667261676d656e746174696f6e5f726174696f3a302e35310d0a6d656d5f616c6c6f6361746f723a6a656d616c6c6f632d332e362e300d0a0d0a232050657273697374656e63650d0a6c6f6164696e673a300d0a7264625f6368616e6765735f73696e63655f6c6173745f736176653a35360d0a7264625f6267736176655f696e5f70726f67726573733a300d0a7264625f6c6173745f736176655f74696d653a313531393836393236380d0a7264625f6c6173745f6267736176655f7374617475733a6f6b0d0a7264625f6c6173745f6267736176655f74696d655f7365633a300d0a7264625f63757272656e745f6267736176655f74696d655f7365633a2d310d0a616f665f656e61626c65643a300d0a616f665f726577726974655f696e5f70726f67726573733a300d0a616f665f726577726974655f7363686564756c65643a300d0a616f665f6c6173745f726577726974655f74696d655f7365633a2d310d0a616f665f63757272656e745f726577726974655f74696d655f7365633a2d310d0a616f665f6c6173745f6267726577726974655f7374617475733a6f6b0d0a616f665f6c6173745f77726974655f7374617475733a6f6b0d0a0d0a232053746174730d0a746f74616c5f636f6e6e656374696f6e735f72656365697665643a34313030320d0a746f74616c5f636f6d6d616e64735f70726f6365737365643a393234383134340d0a696e7374616e74616e656f75735f6f70735f7065725f7365633a360d0a72656a65637465645f636f6e6e656374696f6e733a300d0a73796e635f66756c6c3a300d0a73796e635f7061727469616c5f6f6b3a300d0a73796e635f7061727469616c5f6572723a300d0a657870697265645f6b6579733a323236300d0a657669637465645f6b6579733a300d0a6b657973706163655f686974733a3233323735340d0a6b657973706163655f6d69737365733a3230373733350d0a7075627375625f6368616e6e656c733a3232370d0a7075627375625f7061747465726e733a31300d0a6c61746573745f666f726b5f757365633a343230300d0a0d0a23205265706c69636174696f6e0d0a726f6c653a6d61737465720d0a636f6e6e65637465645f736c617665733a300d0a6d61737465725f7265706c5f6f66667365743a300d0a7265706c5f6261636b6c6f675f6163746976653a300d0a7265706c5f6261636b6c6f675f73697a653a313034383537360d0a7265706c5f6261636b6c6f675f66697273745f627974655f6f66667365743a300d0a7265706c5f6261636b6c6f675f686973746c656e3a300d0a0d0a23204350550d0a757365645f6370755f7379733a373832382e38350d0a757365645f6370755f757365723a373634322e39360d0a757365645f6370755f7379735f6368696c6472656e3a33312e34350d0a757365645f6370755f757365725f6368696c6472656e3a362e37310d0a0d0a23204b657973706163650d0a6462323a6b6579733d32372c657870697265733d302c6176675f74746c3d300d0a0d0a"
